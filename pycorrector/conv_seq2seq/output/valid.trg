第 三 ， 尽 管 T 4 - t i n y 的 参 数 少 于 T 3 - s m a l l ， 但 在 大 多 数 情 况 下 T 4 - t i n y 的 性 能 优 于 T 3 - s m a l l 。 这 可 能 暗 示 着 ， 窄 而 深 的 模 型 比 宽 而 浅 的 模 型 更 好 。
我 们 逐 层 初 始 化 S A E 网 络 ， 每 一 层 都 是 经 过 降 噪 处 理 的 自 动 编 码 器 ， 经 过 训 练 可 以 在 随 机 破 坏 后 重 建 上 一 层 的 输 出 ( V i n c e n t 等 ， 2 0 1 0 ) 。 降 噪 自 动 编 码 器 是 两 层 神 经 网 络 ， 定 义 为 ：
六 、 结 论 与 未 来 工 作
生 成 对 抗 网 络 ： G A N ( G o o d f e l l o w 等 ， 2 0 1 4 ) 可 有 效 生 成 高 质 量 的 合 成 数 据 。   R a d f o r d 等 人 ( 2 0 1 6 ) 提 出 在 下 游 任 务 中 使 用 G A N 的 判 别 器 ， 这 与 我 们 的 方 法 类 似 。   G A N 已 应 用 于 文 本 数 据 ( Y u 等 人 ， 2 0 1 7 ;   Z h a n g 等 人 ， 2 0 1 7 ) ， 尽 管 最 先 进 的 方 法 仍 落 后 于 标 准 的 最 大 似 然 训 练 ( C a c c i a 等 人 ， 2 0 1 8 ;   T e v e t 等 人 。   ， 2 0 1 8 ) 。   虽 然 我 们 不 使 用 对 抗 性 学 习 ， 但 我 们 的 生 成 器 特 别 让 人 想 起 M a s k G A N ( F e d u s 等 人 ， 2 0 1 8 ) ， 它 训 练 生 成 器 填 充 那 些 从 输 入 中 删 除 的 t o k e n 。
表 1 ： G L U E 开 发 集 上 的 小 模 型 比 较 。   B E R T - S m a l l / B a s e 是 我 们 复 现 的 ， 并 使 用 与 E L E C T R A - S m a l l / B a s e 相 同 的 超 参 数 。 I n f e r   F L O P 假 定 1 2 8 长 度 输 入 。 训 练 时 间 不 同 ， 因 为 它 们 是 针 对 不 同 的 硬 件 的 ， 有 的 是 未 优 化 的 代 码 。 即 使 在 单 个 G P U 上 进 行 训 练 ， E L E C T R A 的 性 能 仍 然 很 好 ， 比 同 类 B E R T 模 型 得 分 高 5 个 点 ， 甚 至 超 过 了 更 大 的 G P T 模 型 。
首 先 ， 可 以 将 t e a c h e r 蒸 馏 为 T 6 模 型 ， 但 性 能 会 有 所 下 降 。 所 有 的 T 6 模 型 都 达 到 了 9 9 ％ 的 t e a c h e r 表 现 ， 高 于 D i s t i l B E R T 。
T e x t B r e w e r 还 可 以 与 用 户 的 自 定 义 模 块 一 起 使 用 。 新 的 损 失 函 数 和 调 度 程 序 可 以 轻 松 添 加 到 工 具 包 中 。 例 如 ， 要 使 用 自 定 义 损 失 函 数 ， 首 先 使 用 兼 容 接 口 实 现 损 失 函 数 ， 然 后 使 用 自 定 义 名 称 将 其 添 加 到 预 处 理 的 损 失 函 数 字 典 中 ， 以 便 新 的 损 失 函 数 可 以 作 为 新 的 选 项 值 使 用 的 配 置 ， 并 可 以 被 蒸 馏 器 识 别 。
我 们 的 训 练 策 略 可 以 看 作 是 一 种 自 我 训 练 ( N i g a m ＆ G h a n i ， 2 0 0 0 ) 。 与 自 训 练 一 样 ， 我 们 采 用 初 始 分 类 器 和 无 标 签 的 数 据 集 ， 然 后 使 用 分 类 器 标 签 数 据 集 ， 以 便 对 其 自 身 的 高 置 信 度 预 测 进 行 训 练 。 确 实 ， 在 实 验 中 ， 我 们 观 察 到 D E C 通 过 学 习 高 置 信 度 预 测 来 提 高 每 次 迭 代 中 的 初 始 估 计 ， 从 而 有 助 于 改 善 低 置 信 度 预 测 。
K D 是 一 种 将 知 识 从 t e a c h e r 模 型 转 移 到 s t u d e n t 模 型 的 技 术 ， 通 常 比 t e a c h e r 小 。 对 s t u d e n t 模 型 进 行 训 练 ， 以 模 仿 t e a c h e r 模 型 的 输 出 。 在 B E R T 诞 生 之 前 ， K D 已 应 用 于 N L P 中 的 一 些 特 定 任 务 ， 例 如 机 器 翻 译 ( K i m 和 R u s h ， 2 0 1 6 ；   T a n 等 ， 2 0 1 9 ) 。 虽 然 最 近 对 大 型 预 训 练 模 型 进 行 蒸 馏 的 研 究 专 注 于 发 现 通 用 形 式 蒸 馏 方 法 ， 可 完 成 各 种 任 务 并 受 到 越 来 越 多 关 注 ( S a n h 等 人 ， 2 0 1 9 ;   J i a o 等 人 ， 2 0 1 9 ;   S u n 等 人 ， 2 0 1 9 a   ；   T a n g 等 人 ， 2 0 1 9 ；   L i u 等 人 ， 2 0 1 9 a ；   C l a r k 等 人 ， 2 0 1 9 ；   Z h a o 等 人 ， 2 0 1 9 ) 。
T e x t B r e w e r 也 有 其 局 限 性 。 例 如 ， 其 在 生 成 任 务 ( 如 机 器 翻 译 ) 中 的 可 用 性 尚 未 经 过 测 试 。 我 们 将 继 续 添 加 更 多 样 本 和 测 试 ， 以 扩 展 T e x t B r e w e r 的 应 用 范 围 。
• R T E ： 识 别 文 本 蕴 含 ( G i a m p i c c o l o 等 ， 2 0 0 7 ) 。   给 定 前 提 句 子 和 假 设 句 子 ， 任 务 是 预 测 前 提 是 否 包 含 假 设 。   数 据 集 包 含 来 自 一 系 列 年 度 文 本 蕴 含 挑 战 的 2 . 5 k 训 练 样 本 。
D E C 的 基 本 假 设 是 ， 初 始 分 类 器 的 高 置 信 度 预 测 大 部 分 是 正 确 的 。 为 了 验 证 该 假 设 对 我 们 的 任 务 是 否 成 立 ， 以 及 我 们 对 P 的 选 择 是 否 具 有 所 需 的 属 性 ， 我 们 针 对 每 个 嵌 入 点 | ∂ L / ∂ z i | ， 对 其 软 分 配 q i j ， 绘 制 了 L 的 梯 度 大 小 到 随 机 选 择 的 M N I S T 聚 类 j ( 图 4 ) 。
优 化 D E C 具 有 挑 战 性 。 我 们 要 同 时 解 决 聚 类 分 配 和 基 础 特 征 表 示 。 而 且 ， 与 监 督 学 习 不 同 ， 我 们 不 能 使 用 标 签 数 据 来 训 练 我 们 的 深 度 网 络 。 相 反 ， 我 们 提 议 使 用 从 当 前 软 聚 类 分 配 派 生 的 辅 助 目 标 分 布 来 迭 代 地 聚 类 。 此 过 程 逐 渐 改 善 了 聚 类 以 及 特 征 表 示 。
结 果 显 示 在 表 5 中 。 首 先 ， 我 们 发 现 ， E L E C T R A 对 所 有 输 入 t o k e n ( 而 不 只 是 一 个 子 集 ) 的 损 失 中 受 益 更 多 ： E L E C T R A   1 5 ％ 的 性 能 要 比 E L E C T R A 差 得 多 。 其 次 ， 我 们 发 现 由 于 [ M A S K ] t o k e n 的 预 训 练 微 调 不 匹 配 ， B E R T 性 能 受 到 了 轻 微 损 害 ， 因 为 R e p l a c e   M L M 的 性 能 略 好 于 B E R T 。 我 们 注 意 到 B E R T ( 包 括 我 们 的 实 现 ) 已 经 包 含 了 一 种 技 巧 ， 以 帮 助 改 善 预 训 练 / 微 调 的 差 异 ， 即 m a s k e d   t o k e n 在 1 0 ％ 的 概 率 内 被 随 机 t o k e n 所 替 代 ， 并 在 1 0 ％ 的 概 率 内 被 保 持 不 变 。 但 是 ， 我 们 的 结 果 表 明 ， 这 些 简 单 的 启 发 式 方 法 不 足 以 完 全 解 决 问 题 。 最 后 ， 我 们 发 现 全 t o k e n M L M 是 一 种 生 成 模 型 ， 它 对 所 有 t o k e n ( 而 不 是 子 集 ) 进 行 预 测 ， 弥 补 了 B E R T 和 E L E C T R A 之 间 的 大 部 分 差 距 。 总 体 而 言 ， 这 些 结 果 表 明 ， E L E C T R A 的 大 量 改 进 可 归 因 于 对 所 有 t o k e n 的 学 习 ， 而 较 小 的 归 因 于 减 轻 了 训 练 前 的 微 调 不 匹 配 。
图 2 . 每 种 算 法 的 不 同 超 参 数 选 择 的 聚 类 精 度 。 与 L D G M I 或 S E C 相 比 ， D E C 的 性 能 优 于 其 他 方 法 ， 并 且 对 超 参 数 的 更 改 更 可 靠 。 鲁 棒 性 很 重 要 ， 因 为 在 聚 类 分 析 的 实 际 应 用 中 不 可 能 进 行 交 叉 验 证
图 3 ： 左 图 ： 不 同 生 成 器 / 判 别 器 大 小 ( 隐 藏 神 经 单 数 ) 的 G L U E 分 数 。 有 趣 的 是 ， 生 成 器 小 于 判 别 器 可 以 改 善 结 果 。 右 图 ： 不 同 训 练 算 法 的 比 较 。 由 于 我 们 专 注 于 效 率 ， 因 此 x 轴 显 示 的 是 F L O P ， 而 不 是 训 练 的 步 数 ( 例 如 ， 因 为 E L E C T R A 包 含 生 成 器 ， 所 以 它 的 训 练 步 数 比 B E R T 少 ) 。
• S S T ： 斯 坦 福 情 感 树 库 ( S o c h e r 等 ， 2 0 1 3 ) 。   任 务 是 确 定 句 子 在 情 感 上 是 正 面 还 是 负 面 。   数 据 集 包 含 来 自 电 影 评 论 的 6 7 k 训 练 样 本 。
4 . 3   实 施
3 . 1   蒸 馏 器
表 7 ： 微 调 超 参 数
为 了 研 究 不 平 衡 数 据 的 影 响 ， 我 们 对 具 有 不 同 保 留 率 的 M N I S T 子 集 进 行 了 采 样 。 对 于 最 小 保 留 率 r m i n ， 类 别 0 的 数 据 点 将 以 r m i n 的 概 率 保 留 ， 类 别 9 的 概 率 将 以 1 的 概 率 保 留 ， 而 其 他 类 别 的 数 据 点 之 间 则 保 持 线 性 关 系 。 结 果 ， 最 大 的 簇 将 是 最 小 簇 的 1 / r m i n 倍 。 从 表 4 中 我 们 可 以 看 到 D E C 对 于 簇 大 小 的 变 化 具 有 相 当 强 的 鲁 棒 性 。 我 们 还 观 察 到 ， 在 自 动 编 码 器 和 k - m e a n s 初 始 化 ( 显 示 为 A E + k - m e a n s ) 之 后 ， K L 散 度 最 小 化 ( D E C ) 不 断 提 高 了 聚 类 精 度 。
完 全 监 督 的 方 法 。 我 们 还 包 括 了 完 全 监 督 的 N E R 方 法 进 行 比 较 ， 包 括 ： ( i ) 基 于 R o B E R T a 的 模 型 ( L i u 等 人 ， 2 0 1 9 b ) - 它 采 用 具 有 线 性 层 的 R o B E R T a 模 型 来 执 行 t o k e n - l e v e l 别 的 预 测 ;   ( i i ) B i L S T M - C R F ( M a   a n d   H o v y ， 2 0 1 6 ) 采 用 具 有 字 符 级 C N N 的 双 向 L S T M 来 生 成 t o k e n 嵌 入 ， 将 其 嵌 入 C R F 层 以 预 测 t o k e n 标 签 。
当 前 最 先 进 的 语 言 表 示 学 习 方 法 可 以 看 作 是 学 习 降 噪 自 动 编 码 器 ( V i n c e n t 等 ， 2 0 0 8 ) 。 选 择 无 标 签 输 入 序 列 的 一 小 部 分 ( 通 常 为 1 5 ％ ) ， m a s k e d 掉 那 些 t o k e n s 的 身 份 ( 例 如 B E R T ;   D e v l i n 等 ( 2 0 1 9 ) ) 或 那 些 t o k e n 的 注 意 力 ( 例 如 X L N e t ;   Y a n g 等 ( 2 0 1 9 ) )   ) ， 然 后 训 练 网 络 以 恢 复 原 始 输 入 t o k e n 。 尽 管 由 于 学 习 双 向 表 示 而 比 常 规 语 言 模 型 预 训 练 更 有 效 ， 但 这 些 m a s k 语 言 模 型 ( M L M ) 方 法 会 产 生 大 量 的 计 算 成 本 ， 因 为 每 个 样 本 网 络 仅 从 1 5 ％ 的 t o k e n 中 学 习 。
表 4 中 显 示 了 S Q u A D 上 的 结 果 。 与 G L U E 结 果 一 致 ， 在 给 定 相 同 的 计 算 资 源 的 情 况 下 ， E L E C T R A 的 得 分 要 比 b a s e - m a s k i n g 语 言 模 型 的 方 法 更 好 。 例 如 ， E L E C T R A - 4 0 0 K 优 于 R o B E R T a - 1 0 0 k 和 我 们 的 B E R T 基 线 ， 后 者 使 用 相 似 数 量 的 预 训 练 计 算 。 尽 管 使 用 的 计 算 量 不 到 1 / 4 ， 但 E L E C T R A - 4 0 0 K 的 性 能 也 与 R o B E R T a - 5 0 0 K 相 当 。 而 且 ， 更 长 的 训 练 E L E C T R A 可 以 进 一 步 改 善 结 果 ： E L E C T R A - 1 . 7 5 M 的 得 分 比 S Q u A D   2 . 0 基 准 测 试 中 的 先 前 模 型 都 要 高 。 E L E C T R A - B a s e 也 产 生 了 出 色 的 结 果 ， 得 分 大 大 优 于 B E R T - B a s e 和 X L N e t - B a s e ， 并 且 大 多 数 指 标 甚 至 超 过 了 B E R T - L a r g e 。   E L E C T R A 在 S Q u A D   2 . 0 上 的 性 能 通 常 优 于 1 . 1 。 我 们 猜 测 也 许 替 换 t o k e n 检 测 ( 模 型 区 分 真 实 t o k e n 和 近 乎 真 实 的 假 t o k e n ) 可 能 特 别 适 用 于 S Q u A D   2 . 0 的 可 应 答 性 分 类 ， 在 S Q u A D   2 . 0 中 ， 模 型 必 须 将 可 回 答 的 问 题 与 不 可 回 答 的 假 问 题 区 分 开 。
图 4 ： 左 和 中 ： 不 同 模 型 尺 寸 的 B E R T 和 E L E C T R A 的 比 较 。   右 图 ： 一 个 小 的 E L E C T R A 模 型 收 敛 到 比 B E R T 更 高 的 下 游 任 务 精 度 ， 这 表 明 改 进 不 仅 来 自 更 快 的 训 练 。
• 我 们 证 明 ， 经 过 预 训 练 的 语 言 模 型 还 可 以 在 训 练 过 程 中 提 供 其 他 语 义 信 息 ， 并 减 少 用 于 远 距 离 监 督 的 命 名 实 体 识 别 的 标 签 的 噪 声 。 据 我 们 所 知 ， 这 是 第 一 项 工 作 ， 利 用 了 预 训 练 的 语 言 模 型 的 强 大 特 征 在 远 距 离 监 督 下 完 成 了 开 放 域 N E R 任 务 。
